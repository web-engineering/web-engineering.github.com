<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Web Engineering Textbook: Managing Dependencies</title>
  <link rel="stylesheet" type="text/css" href="stylesheets/style.css" />
  <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

  <link rel="stylesheet" type="text/css" href="stylesheets/syntaxhighlighter/shCore.css" />
  <link rel="stylesheet" type="text/css" href="stylesheets/syntaxhighlighter/shThemeRailsGuides.css" />

  <link rel="stylesheet" type="text/css" href="stylesheets/fixes.css" />
  <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" />

  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon" />
</head>
<body class="guide">
  <div>
    <a href="http://github.com/web-engineering/web-engineering-textbook/"><img style="position: fixed; top: 0; right: 0; border: 0; z-index: 10;" src="images/forkme.png" alt="Fork me on GitHub"></a>
  </div>
  <div id="topNav">
    <div class="wrapper">
      <strong class="more-info-label">Learn more at the sources: </strong>
      <ul class="more-info-links s-hidden">
        <li class="more-info"><a href="https://git-scm.com/documentation">Git Documentation</a></li>
        <li class="more-info"><a href="https://try.github.io/">Try Git</a></li>
        <li class="more-info"><a href="http://refactoring.com/catalog/">Refactoring Catalog</a></li>
      </ul>
    </div>
  </div>
  <div id="header">
    <div class="wrapper clearfix">
      <h1><a href="index.html" title="Return to home page">Web<span>Engineering</span></a></h1>
      <ul class="nav">
        <li><a class="nav-item" href="index.html">Home</a></li>
        <li class="guides-index guides-index-large">
          <a href="index.html" onclick="guideMenu(); return false;" id="guidesMenu" class="guides-index-item nav-item">Index  &#x25BC;</a>
          <div id="guides" class="clearfix" style="display: none;">
            <hr />
              <dl class="L">
                <dt>Basics</dt>
                <dd><a href="vi.html">vi</a></dd>
                <dd><a href="public_key.html">Using Public Key Cryptography</a></dd>
                <dd><a href="git_basics.html">Git Basics</a></dd>
                <dt>Workflows</dt>
                <dd><a href="git_branching.html">Git Branching and Merging</a></dd>
                <dd><a href="pair_programming.html">Pair Programming</a></dd>
                <dd><a href="testing.html">Testing</a></dd>
                <dd><a href="tdd.html">Test Driven Development</a></dd>
                <dd><a href="refactoring.html">Refactoring</a></dd>
                <dd><a href="dependencies.html">Managing Dependencies</a></dd>
              </dl>
              <dl class="R">
                <dt>Web Operations</dt>
                <dd><a href="webserver.html">Webserver</a></dd>
              </dl>
          </div>
          </li>
        <li><a class="nav-item" href="https://github.com/web-engineering/web-engineering-textbook/">Contribute</a></li>
      </ul>
      </div>
    </div>
  </div>
  <hr class="hide" />

  <div id="feature">
    <div class="wrapper">
                <div id="subCol">
            <h3 class="chapter"><img src="images/chapters_icon.gif" alt="" />Chapters</h3>
            <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<ol class="chapters">
<li>
<a href="#dependencies">Dependencies</a>

<ul>
<li><a href="#dynamiclly-linked-libraries">dynamiclly linked libraries</a></li>
<li><a href="#package-names-and-a-central-database">package names and a central database</a></li>
<li><a href="#how-to-install">How to install</a></li>
<li><a href="#where-is-the-code-installed-questionmark">Where is the code installed?</a></li>
<li><a href="#security-considerations">Security considerations</a></li>
</ul>
</li>
<li>
<a href="#dependency-hell">Dependency Hell</a>

<ul>
<li><a href="#escape-from-depencency-hell">Escape from Depencency Hell</a></li>
<li><a href="#defining-versions">Defining Versions</a></li>
<li><a href="#keeping-up-to-date">Keeping Up To Date</a></li>
</ul>
</li>
<li><a href="#dependencies-risk">Dependencies = Risk</a></li>
<li><a href="#apt-for-linux">apt for Linux</a></li>
<li><a href="#brew-for-mac-os">brew for mac os</a></li>
<li><a href="#choco-for-windows">choco for windows</a></li>
<li><a href="#gem-and-bundler-for-ruby">gem and bundler for ruby</a></li>
<li><a href="#npm-for-javascript-and-node-js">npm for javascript and node.js</a></li>
<li><a href="#composer-and-packagist-for-php">composer and packagist for php</a></li>
<li><a href="#references">References</a></li>
</ol>
</body></html>

          </div>

      <h2>Managing Dependencies</h2><p>The program you write will depend on other code
that other people have written.  This guide will teach you 
how to install, use and upgrade dependencies for your web application. 
It covers ruby, javascript and php.</p><p>After working through this guide you will be able to:</p>
<ul>
<li>understand what a package manager does for you</li>
<li>install packages for javascript and node with <code>npm</code></li>
<li>install gems f√ºr ruby with <code>gem</code> and <code>bundler</code></li>
<li>install libraries for php with <code>composer</code></li>
<li>install programs and libraries for your operating system with <code>brew</code>, <code>apt</code> or <code>choco</code></li>
<li>know how to keep your dependencies current</li>
</ul>

    </div>
  </div>

  <div id="container">
    <div class="wrapper">
      <div id="mainCol">
        <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<h3 id="dependencies">1 Dependencies</h3>
<p>The program you write will depend on other code
that other people have written. Some of this code
has been packaged into operating systems or applications:
Linux, Postgres, Apache, nginx, and so on.</p>
<p>But you also use smaller pieces of code that you include
in your source code or link to your code after compiling.
These dependencies are called libraries, packages or gems in different
programming languages.</p>
<p>We will discuss six different systems:</p>
<ul>
<li>Package management for the operating system:

<ul>
<li>
<code>apt</code> a package manager for Linux (used in debian, ubuntu, and several other distributions)</li>
<li>
<code>brew</code> a package manager for mac os</li>
<li>
<code>choco</code> a package manager for windows</li>
</ul>
</li>
<li>Package management for a programming language:

<ul>
<li>
<code>gem</code> and <code>bundler</code> for ruby</li>
<li>
<code>npm</code> for javascript and node.js</li>
<li>
<code>composer</code> for php</li>
</ul>
</li>
</ul>
<h4 id="dynamiclly-linked-libraries">1.1 dynamiclly linked libraries</h4>
<p>Why do we need to look at <code>apt</code>, <code>brew</code> or <code>choco</code>?  Isn't the
package manager for my main programing language enough?</p>
<p>In many cases using php-only or ruby-only libraries will be enough.
But sometimes the libraries we use in our dynamic languages use
other code originally written in c or c++.</p>
<p>The image processing library <code>imagemagick</code> is a good example.  If you want to use the ruby gem <a href="https://rubygems.org/gems/rmagick/versions/2.15.4">rmagick</a> to edit images you will find that to install
the gem, you first need to install the program and the library "ImageMagick".
You do this using apt or brew or
<a href="http://www.imagemagick.org/script/binary-releases.php#windows">the windows installer with dynamic link libraries</a>.</p>
<p>The result of installing imagemagick with brew is the file <code>libMagickCore-6.Q16.2.dylib</code> and two other libraries.  These are libraries that can be used by multiple programs on your computer when they are dynamically linked to those programs.</p>
<p>When installing the ruby gem with <code>gem install rmagick</code> you get the following output:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
Building native extensions.  This could take a while...

</pre>
</div>
<p>Sometimes you need to set include paths when installing gem, e.g.:</p>
<div class="code_container">
<pre class="brush: plain; gutter: false; toolbar: false">
&gt; gem install eventmachine 
... error messages ...
In file included from binder.cpp:20:
./project.h:116:10: fatal error: 'openssl/ssl.h' file not found
#include &lt;openssl/ssl.h&gt;
         ^
&gt; brew install openssl
&gt; gem install eventmachine -- --with-cppflags=-I/usr/local/opt/openssl/include

</pre>
</div>
<h4 id="package-names-and-a-central-database">1.2 package names and a central database</h4>
<p>To enable easy installation of a dependency with just one command we need
a central database that contains the information on all available packages.
These databases typically also offer a web page with search functionality:</p>
<ul>
<li>
<a href="http://de.archive.ubuntu.com/ubuntu">apt</a> packages are kept on ftp servers and are not searchable there. other sources can be added to <code>/etc/apt/sources.list</code>
</li>
<li>
<a href="https://github.com/Homebrew/homebrew-core">homebrew/core</a> is a repository on github, but other "taps" (sources of packges) can be added</li>
<li>choco</li>
<li>
<a href="https://rubygems.org/">rubygems.org</a> for ruby</li>
<li>
<a href="https://www.npmjs.com/">npmjs.com</a> for javascript</li>
<li>
<a href="https://packagist.org/">packagist.org</a> for php and composer
Package names need to be unique.  Version numbers are often given out according to <a href="http://semver.org/">semantic versioning</a>.</li>
</ul>
<h4 id="how-to-install">1.3 How to install</h4>
<ul>
<li><code>apt-get install imagemagick</code></li>
<li><code>brew install imagemagick</code></li>
<li><code>choco install imagemagick</code></li>
<li><code>gem install rmagick</code></li>
<li><code>npm install imagemagick</code></li>
<li>
<code>composer install imagemagick</code>  - does not work, needs PECL </li>
</ul>
<h4 id="where-is-the-code-installed-questionmark">1.4 Where is the code installed?</h4>
<p>All the package managers distinguish between installing <strong>globally</strong> - for all users and projects on a computer and installing <strong>locally</strong>.  This might mean installing in a way that only one user can use, or it might mean installing into a projects directory.</p>
<p>When you deploy your project to a production server you again face this question: should
the dependencies be installed globally or locally?</p>
<h4 id="security-considerations">1.5 Security considerations</h4>
<p>Downloading and using software is always dangerous. With a package
management system a lot of downloads happen automatically.  So we want
to make sure the software we download is really what it is supposed to be.</p>
<p>A package management system can offer different methods of making it more secure:
* comparing <strong>checksums</strong> of the code to  make sure the downloaded package contains the same code as the original package 
* cryptographically <strong>signing</strong> the code in the package and checking this signature before installing. This ensures
that only the original author of the package can release new versions.  </p>
<h3 id="dependency-hell">2 Dependency Hell</h3>
<p>For a big web project you will be using a lot of dependencies. This will lead
to two problems (here shown in a ruby projects with gems):</p>
<ol>
<li>dependency resolution: gem A depends on version 1.1 of gem C, while gem B wants at least version 1.5.  You need to find the right version of every gem in your project that actually fits together</li>
<li>different installation: when deploying to a production server, or even just when sharing code with other developers you need to make sure that the same constellation of gems and versions is used on every machine</li>
</ol>
<p>If this all goes horribly wrong you are in "dependency hell": you can't find the right versions
of gems to make your code work again on a new machine or after an update.</p>
<h4 id="escape-from-depencency-hell">2.1 Escape from Depencency Hell</h4>
<p><img src="images/bundler-small.png" alt="bundler"></p>
<p>Bundler is the name of the ruby tool that solves this problem for ruby.
Bundler is itself a gem, so you install it with <code>gem install bundler</code>.
Beware: the command you will be using called <code>bundle</code>, not bundler.</p>
<p>There is how it works: In every ruby project you write
a <code>Gemfile</code> in which you define which gems and (to a certain degree) which versions you want.
When you run <code>bundle install</code> bundler will:</p>
<ul>
<li>read the Gemfile, </li>
<li>pick out compatible versions of all the gems (if possible), </li>
<li>install all these gems</li>
<li>write <code>Gemfile.lock</code>
</li>
</ul>
<p>The lock-file contains a complete list of all the gems necessary for
your project, and their version numbers.  This also includes dependencies of you
dependencies, that you don't even knew you were using!
The version numbers are now locked down, and will not change!</p>
<p>When deploying to a new development machine or the production server, 
you run <code>bundle install</code> and the exact same versions are now installed.</p>
<p>All modern package managment systems offer a form of this solution, with</p>
<ul>
<li>on file that is written by hand that contains your <strong>wishes</strong> </li>
<li>another file that is created by the package manager, that contains the exact version numbers</li>
</ul>
<h4 id="defining-versions">2.2 Defining Versions</h4>
<p>When definig your wishes for dependencies you can specify which versions should be used.
But don't overdo it!  The package manager does a good job picking versions.
If you specify every version number by hand you are doing too much work. And you
are potentially locking yourself in to old versions.</p>
<p>Some examples of the different ways of specifying version number and source in a ruby <code>Gemfile</code>:</p>
<div class="code_container">
<pre class="brush: ruby; gutter: false; toolbar: false">
# Gemfile
source 'https://rubygems.org'

ruby '2.1.5'

gem 'devise'
gem 'rails', '4.2.5'
gem 'uglifier', '&gt;= 1.3.0'
gem 'coffee-rails', '~&gt; 4.1.0'

</pre>
</div>
<p>Giving an exact version number fixes that version, so only
version 4.2.5 of rails will be allowed here.  Using the "greater-or-equal-than" sign
you can require any version greater or equal to 1.3.0.  So 1.2.7 is forbidden,
but 1.3.2 or 1.4.0 or 2.2.0 is allowed.</p>
<p>The arrow <code>~&gt;</code> will only allow an increase in the 
last (right most) number, so <code>~&gt; 4.1.0</code> does allow <code>4.1.17</code> but not <code>4.2</code>.
This is called a pessimistic version constraint, read more about 
it in <a href="http://guides.rubygems.org/patterns/#pessimistic-version-constraint">the rubygem documentation</a>.</p>
<h4 id="keeping-up-to-date">2.3 Keeping Up To Date</h4>
<p>Let's assume you list 12 dependencies in your project. This might result in 36 dependencies 
being installed in all.  Now assume each dependency releases a new version once a year. You
have to be prepared for updating several dependencies each month!</p>
<p>To update the versions you need to override the lock-file and allow a change in version numbers.</p>
<p>For each dependency system we discussed there are services out there that will tell
you about new version or -- even more important -- new security updates for your dependencies.</p>
<h3 id="dependencies-risk">3 Dependencies = Risk</h3>
<p>While using a third party library today will make you more
productive, it could well harm you in the long wrong:</p>
<ul>
<li>It might change drastically in the future, like Angular 2 did. See <a href="https://daveceddia.com/angular-2-should-you-upgrade/">Ceddias article on upgrading von Angular 1 to Angular 2</a>
</li>
<li>It might be discontinued and disappear completely, like Parse did three years after it was <a href="https://www.crunchbase.com/organization/parse#/entity">aquired by facebook</a>. See <a href="http://blog.parse.com/announcements/moving-on/">their final announcement</a>
</li>
<li>It might disappear and be replaced, causing havoc in the meantime, like left_pad did. See <a href="http://www.theregister.co.uk/2016/03/23/npm_left_pad_chaos/">article in theregister on left_pad</a>
</li>
</ul>
<p>These examples were taken from <a href="https://medium.freecodecamp.com/code-dependencies-are-the-devil-35ed28b556d#.4a7d59i6u">a longer article</a> that discusses ways to minimize the risk.</p>
<h3 id="apt-for-linux">4 apt for Linux</h3>
<h3 id="brew-for-mac-os">5 brew for mac os</h3>
<h3 id="choco-for-windows">6 choco for windows</h3>
<h3 id="gem-and-bundler-for-ruby">7 gem and bundler for ruby</h3>
<h3 id="npm-for-javascript-and-node-js">8 npm for javascript and node.js</h3>
<h3 id="composer-and-packagist-for-php">9 composer and packagist for php</h3>
<h3 id="references">10 References</h3>
<ul>
<li>Package management for the operating system:

<ul>
<li>
<code>apt</code> for Linux, e.g. for <a href="https://help.ubuntu.com/lts/serverguide/apt.html">Ubuntu</a> and <a href="https://www.debian.org/doc/manuals/debian-reference/ch02.en.html">Debian</a>
</li>
<li>
<code>brew</code> for mac os <a href="http://brew.sh/">brew.sh</a>
</li>
<li>
<code>choco</code> for windows <a href="https://chocolatey.org/">chocolatey.org</a>
</li>
</ul>
</li>
<li>Package management for a programming language:

<ul>
<li>
<code>gem</code> and <code>bundler</code> for ruby <a href="http://guides.rubygems.org/rubygems-basics/">rubygems.org</a> and <a href="http://bundler.io/">bundler.io</a>
</li>
<li>
<code>npm</code> for javascript and node.js <a href="https://www.npmjs.com/">npmjs.org</a>
</li>
<li>
<code>composer</code> for php <a href="https://getcomposer.org/">getcomposer.org</a> and <a href="https://packagist.org/">packagist.org</a>
</li>
</ul>
</li>
</ul>
</body></html>

      </div>
    </div>
  </div>

  <hr class="hide" />
  <div id="footer">
    <div class="wrapper">
      <p class="copyright">published under <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/at/deed.de">creative commons by-nc-sa</a> in 2012-2016 by <a href="http://brigitte-jellinek.at">Brigitte Jellinek</a>.
      </p><p>If you want to contribute: <a href="https://github.com/web-engineering/web-engineering-textbook/fork">fork the source on github</a>
        and edit <a href="https://github.com/web-engineering/web-engineering-textbook/blob/master/source/dependencies.md">dependencies.md</a>
      </p>
    </div>
  </div>

  <script type="text/javascript" src="javascripts/jquery.min.js"></script>
  <script type="text/javascript" src="javascripts/responsive-tables.js"></script>
  <script type="text/javascript" src="javascripts/guides.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shCore.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushRuby.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushXml.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushSql.js"></script>
  <script type="text/javascript" src="javascripts/syntaxhighlighter/shBrushPlain.js"></script>
  <script type="text/javascript">
    SyntaxHighlighter.all()
    $(guidesIndex.bind);
  </script>
  </body>
</html>
